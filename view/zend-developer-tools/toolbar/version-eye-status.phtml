<?php
/* @var $collector \VersionEyeModule\Collector\DependencyStatusCollector */

$statuses = $collector->getCollectedDependencyStatuses();
if ( ! $statuses) {
?>
<div class="zdt-toolbar-entry">
    <div class="zdt-toolbar-preview">
        <!-- alert icon? API key link? -->
        <img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAA0JJREFUOMudVEFoI1UY/t4kk2yUylZlFNuaDduw2A2IiCD0WgQPqVUsewgt6kXQXEpPnoqnii3tJeAacVdahNLSiyClttCSgdimCZWCuOykk5mNEtYsNGYmTCaZ934vWai4ibXf6f3vfXx8//++9xi6QNO0d0Oh0LoQouW67s1oNGrgApDOF4ZhfGea5hQAnJ2dRTjnPtd1n2o0Gi8BgGmaXxiG8WUvQfZ4USqV7vp8vg+EEGCMnTLGrneOCAAjIgPANQAQQnwSiUS+6uqwv79fSqVST3POCQCI6HogEIBt2+S6LvP5fCCia0QEy7L48vLyMxdp/4qqqm3DMEjXdZFMJu8DSEuStLqwsPDANE0yTZN2d3dNAL6eSsVi8X1N05K6rlO5XKbZ2dmfAQyco9xcXFy8XyqVSNd1R9O0j4rF4uSTtPydmawRESMiVKtVpFKpWwD+OMf7tVKpfFqv138KhUJBAN8QEQHYeKKgZVlMlmUWCAQgyzKazebvjLF/EKempiqSJEEIwZrNJjjn6OpwYmLie0VRXlhbW3srGAwin89/C+DD80TO+bIsy3Acx0skEj82Gg2rZ2wAYHt7mw8ODkpEBCL6mohuA5AZY58DeFuSJOi6Xo7H4y//Zw5PTk6WOOczjDF0WgOAdudGpcd7RNSWZfnjWCx2t9dLkVRVDQshUKvV2rlc7qFt24Jz7uecs1qtxo+Ojv50HIc3m03f1tbWiwBQKBQCvdITmZyc/CUej98G8NrMzMydg4MDoaoqjY2NfQbg9enp6d3x8fEdAFcBIJfL3Ts+Ppa6zhDAFQAyAGtlZWU6HA7fcV0X1Wr1lUQioQF4fmNj4+rAwEBGkqQMY+wWEW0KId4kondGR0cLrJvdoaGhG4yx9wB4RJQul8t/AUA0Gn1uaWnpkaIoOD09dSORSLBer2Nzc3MknU7/hv+LTCZD2WyW5ufnKwCSc3NzejabpUwm4/3r+7oIdnZ2XNu2xfDwsENEP8RisbrjOLS/v29dStC27Tc8z2OKokT29vbuKYryqud58Pv9E5cSbLVarXw+/2h1dTXX19cXWl9fLxweHj6s1WptXBJ+ADcAPDsyMmIwxsKdOggAfwOpZLGNo7pH7AAAAABJRU5ErkJggg==" alt="VersionEye dependencies statuses">
        <span class="zdt-toolbar-info">
            No dependencies!
        </span>
    </div>
    <div class="zdt-toolbar-detail">
        <span class="zdt-toolbar-info version-eye-toolbar-info-heading">
            <a href="https://github.com/Ocramius/VersionEyeModule" target="_blank">VersionEyeModule</a>
            <span class="zdt-toolbar-info version-eye-toolbar-info">
                Did you setup and configure the
                <a href="https://www.versioneye.com/settings/api" target="_blank">API key</a> for
                <a href="https://www.versioneye.com/settings/api" target="_blank">VersionEye</a> and set it in
                your configuration?
            </span>
        </span>
    </div>
</div>
<?php
return;
}
?>
<div class="zdt-toolbar-entry">
    <div class="zdt-toolbar-preview">
        <!-- @todo versioneye icon? -->
        <img src="data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAA0JJREFUOMudVEFoI1UY/t4kk2yUylZlFNuaDduw2A2IiCD0WgQPqVUsewgt6kXQXEpPnoqnii3tJeAacVdahNLSiyClttCSgdimCZWCuOykk5mNEtYsNGYmTCaZ934vWai4ibXf6f3vfXx8//++9xi6QNO0d0Oh0LoQouW67s1oNGrgApDOF4ZhfGea5hQAnJ2dRTjnPtd1n2o0Gi8BgGmaXxiG8WUvQfZ4USqV7vp8vg+EEGCMnTLGrneOCAAjIgPANQAQQnwSiUS+6uqwv79fSqVST3POCQCI6HogEIBt2+S6LvP5fCCia0QEy7L48vLyMxdp/4qqqm3DMEjXdZFMJu8DSEuStLqwsPDANE0yTZN2d3dNAL6eSsVi8X1N05K6rlO5XKbZ2dmfAQyco9xcXFy8XyqVSNd1R9O0j4rF4uSTtPydmawRESMiVKtVpFKpWwD+OMf7tVKpfFqv138KhUJBAN8QEQHYeKKgZVlMlmUWCAQgyzKazebvjLF/EKempiqSJEEIwZrNJjjn6OpwYmLie0VRXlhbW3srGAwin89/C+DD80TO+bIsy3Acx0skEj82Gg2rZ2wAYHt7mw8ODkpEBCL6mohuA5AZY58DeFuSJOi6Xo7H4y//Zw5PTk6WOOczjDF0WgOAdudGpcd7RNSWZfnjWCx2t9dLkVRVDQshUKvV2rlc7qFt24Jz7uecs1qtxo+Ojv50HIc3m03f1tbWiwBQKBQCvdITmZyc/CUej98G8NrMzMydg4MDoaoqjY2NfQbg9enp6d3x8fEdAFcBIJfL3Ts+Ppa6zhDAFQAyAGtlZWU6HA7fcV0X1Wr1lUQioQF4fmNj4+rAwEBGkqQMY+wWEW0KId4kondGR0cLrJvdoaGhG4yx9wB4RJQul8t/AUA0Gn1uaWnpkaIoOD09dSORSLBer2Nzc3MknU7/hv+LTCZD2WyW5ufnKwCSc3NzejabpUwm4/3r+7oIdnZ2XNu2xfDwsENEP8RisbrjOLS/v29dStC27Tc8z2OKokT29vbuKYryqud58Pv9E5cSbLVarXw+/2h1dTXX19cXWl9fLxweHj6s1WptXBJ+ADcAPDsyMmIwxsKdOggAfwOpZLGNo7pH7AAAAABJRU5ErkJggg==" alt="VersionEye dependencies statuses">
        <span class="version-eye-toolbar-info">
            <?php echo count($statuses['dependencies']); ?> dependencies
        </span>
    </div>
    <div class="zdt-toolbar-detail">
        <span class="zdt-toolbar-info version-eye-toolbar-info-heading">
            <a href="https://github.com/Ocramius/VersionEyeModule" target="_blank">VersionEyeModule</a>
        </span>
        <span class="zdt-toolbar-info version-eye-toolbar-info">
            <?php foreach ($statuses['dependencies'] as $dependency): ?>
                <hr/>
                <a class="version-eye-package-name" href="https://www.versioneye.com/package/<?php
                    echo $this->escapeHtmlAttr(str_replace('/', '--', $dependency['prod_key']));
                ?>" target="_blank">
                    <?php echo $this->escapeHtml($dependency['name']); ?>
                </a>
                <br/>
                <span class="version-eye-package-version<?php
                    if ($dependency['outdated']) {
                        echo ' version-eye-package-outdated';
                    }
                ?>">
                    <span class="version-eye-package-comparator">
                        <?php echo $this->escapeHtml($dependency['comparator']); ?>
                    </span>
                    <?php echo $this->escapeHtml($dependency['version_requested']); ?>
                </span>
                <?php if ($dependency['outdated']) { ?>
                    <span class="version-eye-package-upgrade">
                        <?php echo $this->escapeHtml($dependency['version_current']); ?>
                    </span>
                <?php } ?>
            <?php endforeach ?>
        </span>
    </div>
</div>
<style>
.version-eye-toolbar-entry .version-eye-toolbar-detail .version-eye-toolbar-info
{
    font-size: 11px;
    max-width: 600px;
    witdh: 600px;
    max-height: 300px;
    overflow-y: scroll;
    overflow-x: hidden;
}

.version-eye-toolbar-entry .version-eye-toolbar-info .version-eye-clear
{
    clear: both;
    display: block;
}

.version-eye-toolbar-info hr
{
    border: 0;
    border-top: 1px solid #ffffff;
    clear: both;
    margin-top: 0px;
    margin-bottom: 0px;
}

a.version-eye-package-name
{
    color: #149bdf;
}

.version-eye-package-comparator
{
    color: #ffffff;
}

.version-eye-package-version
{
    color: #70d900;
}

.version-eye-package-version .version-eye-package-outdated
{
    color: #dd1144;
}

.version-eye-package-upgrade
{
    color: #f89406;
    float: right;
}
</style>
